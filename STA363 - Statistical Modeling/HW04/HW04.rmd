---
title: "HW04"
author: "Noah Dunn"
date: "September 29, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(knitr)
library(GGally)
library(lindia)
library(ggfortify)
```

###Problem 1

##1. 
```{r}
iceLakeData <- read.csv("iceThickness.csv")
glimpse(iceLakeData)

ggscatmat(iceLakeData)
```

Thickness, Days of Ice Coverage, Days less than 8 degrees Centigrade, all appear fairly normal.
Average Snow Depth shows a left skew.

With respect to thickness, there is a moderately postive correlation between Thickness and Days of Ice Coverage.
There is also a moderately positive correlation between Thickness and Days with temperatures less than 8 degrees.

##2.
```{r}
iceLakeLinear <- lm(Thickness ~ DaysIceCover + DaysLessThan8 + AvgSnowdepth, data=iceLakeData)
autoplot(iceLakeLinear)

```
##3.
Normality plot looks sufficient. Residuals vs. Fitted Plot plot can be seen as a fairly linear relationsip,
as there is no clear fanning or constant curvature. 

##4.
```{r}
summary(iceLakeLinear)
```

The model is capable of significantly predicting Thickness at 95% confidence interval due to an overall model p-value of 0.0006422 < 0.05. Days of Ice Cover, Days Less than 8 Degrees C, and Average Snow Depth are all significant predictor variables. 

##5.

The model suggests that 78.59% of the variability in Thickness can be explained by Days Ice Covered, Days Less Than 8, and Average Snow Depth.

##6.

With all other factors held constant, one mm increase in average Snow Depth will, on average, decrease Ice Thickness by 2.8495 mm.
With this in mind, the larger the average snow depth is, the lesser the maximum ice thickness will be. This analysis can only take
place if all other factors are held constant, and because the snow depth predictor is significant. 

###Problem 2

##1.

```{r}
satScores <- read.csv("stateSATscores.csv")
glimpse(satScores)

ggplot(satScores, aes(x=PercentSAT, y=SAT)) +
  geom_point() + 
  geom_smooth() +                 # adds a smoother
  xlab("Percentage of People who have taken the ACT") +
  ylab("SAT Total Score Average")

```

It is a downward sloping curved line. As percentage of people who take the ACT increases,
SAT total score average appears to decrease.

##2.

```{r}
satScores.lm <- lm(SAT ~ PercentSAT, data= satScores )
autoplot(satScores.lm)
```

In the residuals plot, there is the same trend of the downward sloping line.

##3.

```{r}
satScores <- satScores %>%
  mutate(sqrtPercentSAT = sqrt(PercentSAT))
```

##4.
```{r}
satScores.mr <- lm(SAT ~ PercentSAT + sqrtPercentSAT, data= satScores )
autoplot(satScores.mr)

```

The curvature has nearly dissapated. This data appears more linear than the previous regression we ran without 
sqrtPercentSAT.

##5.
```{r}
summary(satScores.mr)
```
The overall model possesses a p-value of 2.2x10^-6 < 0.05, which is significant at a 95% confidence level. 
Both PercentSAT and sqrtPercentSAT are significant predictors in predicting our response average overal SAT score,
as evidenced by the R output.

##6.
86.13 percent of the variability in SAT composite average score can be explained by Percent SAT and sqrt Percent SAT.


##7.
```{r}
satScores.megamr <- lm(SAT ~ PercentSAT + sqrtPercentSAT + Expenditure + PT.Ratio + Salary, data= satScores )
autoplot(satScores.megamr)
summary(satScores.megamr)

```

Although we observe almost a three percent increase in variability and almost a two percent decrease in error, the three
factors we added are all insignificant at a 95% significance level. We have a slightly more linear residuals vs fitted plot, but this
model cannot be seen as better because three of our predictors are still insignificant. 















