---
title: "Homework 2"
author: "Noah Dunn"
date: "September 6, 2018"
output: html_document
---
#Problem 1
The usage of 32 metal sample pieces instead of 33 is a curious decision by my understanding, as I would have picked 
33 in order to allow for 11 tests of each solvent. With 32 samples, in order to prevent bias/nuisance interference,
we could choose the two samples that recieve an extra test with a Random Number Generator and then have a blinded professional choose prepoured samples to clean the metal sample presented. The alternative is we can take what I believe to be the experimenter's approach. We assign each solvent to a number 1 through 3, and use a Random Number Generator to choose a number 1 through 3, 32 seperate times to pick the solvent we will use on each metal. 

```{r, message=FALSE, warning=FALSE}
library(tidyverse)
library(knitr)
library(ggfortify)
library(emmeans)
```
```{r, message=FALSE}
sorprate <- read.csv("http://www.users.miamioh.edu/hughesmr/sta363/soprate.csv")
```
#Problem 2

```{r, message=FALSE}
sorprate%>% 
  group_by(solvent) %>% 
  summarize(Mean=mean(sorp.rate), 
            SD=sd(sorp.rate),
            Var=var(sorp.rate), 
            N=n() ) %>% 
  kable()
```

The mean sorption rate for the solvent Esters looks lower than the other two values, but it also a fairly low SD. 

The highest mean, the Chloroalkanes group, has the highest SD/Variance, as well as the lowest Sample(N = 9)

Aromatics sits directly in the middle with the middle mean and middle SD value

#Problem 3 

```{r}
ggplot(sorprate) + 
  geom_boxplot(aes(x=solvent,y = sorp.rate))+
  theme_minimal()+
  xlab("Solvent")+
  ylab("Sorption Rate")+
  ggtitle("Sorprate Data", subtitle = NULL)

```

With a visual presentation now availible, it is clear just how close the averages of Aromatics and Chloroalkanes appear to be. The Variance built from the standard deviation of the Choroalkanes overlaps the entire range of the Aromatics, which has a very small variance. Esters very clearly has the smallest mean, which appears outside of the large range of Chloroalkanes.

#Problem 4
```{r}
sorprate.anova <- aov(sorp.rate ~ solvent, data=sorprate)
summary(sorprate.anova)
```
The degrees of freedom for the solvents are 2(3 solvents - 1), and the degrees of freedom for the Residuals are 29(32 samples - 1(3 sets)) and the F-value for 
this data set is F = 24.51

Utilizing the information gained from the one-way ANOVA test, we can conclude that at least two of the Solvent differ from each other in a statisitcally significant manner. The p-value printed is 5.86 x 10^-7 which is quite less than 0.05. 

#Problem 5
```{r}
autoplot(sorprate.anova)
```

The Residual plot line of best fit appears very close to parallel with the horizontal axis, indicating equal variance assumption is valid. The normal QQ plot is not a perfectly straight line, but the points appear close enough to the predicted line to be safe to check the normality assumption.

#Problem 6
```{r}
library(emmeans)
sorprate.mc <-  emmeans(sorprate.anova, "solvent")
contrast(sorprate.mc, "pairwise")
```
As observed by the p-values in the table. There is statisical significance
differences noted between Aromatics and Ester, as well as Choloroalkanes and Esters.
In context, the mean effect that Aromatics have on cleaning the metal parts is statistically greater than that of Ester. Also, the mean effect that Choloroalkanes have on cleaning metal is statisically greater than that of Ester. 

```{r}
plot(confint(contrast(sorprate.mc, "pairwise")))
```
Here is the confidence interval plot for posterity sake.


