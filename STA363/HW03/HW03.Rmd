---
title: "HW3"
author: "Noah Dunn"
date: "September 15, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(ggfortify)
library(emmeans)
library(tidyverse)
```

#Woodward Data Analysis

##EDA(Explanatory Data Analysis)

Experimental Units: 22 different runners are used a sample 

Factors of Interest: Path from one base to another

Factor Levels: There are 3 levels, one for each path: Round-out, Narrow Angle, and Wide Angle

Treatments: Each of the 3 running paths

Nuisance Control: The 22 runners are a random sample of runners, each runner takes each path in a random order.

```{r}
woodward <- read.csv("baseballRunning.csv", header = TRUE) 
woodwardClean <- woodward %>%
  gather(key = RunningTechnique, value = Time, c(Round.out, Narrow.Angle, Wide.Angle)) %>%
  arrange(Player) %>%
  mutate(Player = as.factor(Player), RunningTechnique = as.factor(RunningTechnique)) 
  glimpse(woodwardClean)
```


```{r}
ggplot(woodwardClean) + 
  geom_line(aes(x=RunningTechnique, y=Time, group=Player), color="black" ) +
  theme_minimal() 
```

Initial Visual speculation demonstrates that the Round out technique requires a larger time per runner than Narrow Angle and Wide Angle, aside from a few fairly flagrant seemingly appearent outliers. Wide Angle and Narrow Angle appear to be close in value per runner, but Wide Angle does appear to be slightly lower in the majority of the runners.
With the knowledge that the each runner is his/her own homogeneous set of conditions, a one-way Block ANOVA seems most fitting to account for this in combination with our one factor with three factor levels.

##Inference

We utilize a one-way Block ANOVA in which we evaluate time values for running techniques with respect to each player.

```{r}
woodwardClean.anova <- aov(Time ~ RunningTechnique + Player, data = woodwardClean)
autoplot(woodwardClean.anova)
summary(woodwardClean.anova)
```

The residuals vs fitted plot for this data set appears to demonstrate potentially serious fanning. This will be brought up again in the conclusion.
The normality graph appears to fall in a fairly straight line, however there are some very exhorbitant outliers that could affect our results.

The p-value for the Running Technique was shown to be 0.00408, and we also are aware that there exists a significant difference between the players under analysis. This provides a further example of why it is necessary to block this study, as player to player difference would drastically impact result.

We proceed further with a Tukey's Honestly Significant Difference Method to determine which values are significantly different

```{r}
woodwardClean.mc <- emmeans(woodwardClean.anova, "RunningTechnique")
contrast(woodwardClean.mc, "pairwise")
```
As displayed in the table, Round out yields a statisically significant larger time than Wide Angle, and Narrow Angle yields a statisically significant large time than wide angle.
Wide angle, thus, is the statisically significant fastest route to go between two bases. However, this conclusion must be kept in the context that our equal variance displayed fanning and our normality plot  contained outliers. Our conclusion may not hold if these two cases are problematic. 

#Cow Data Analysis

##EDA(Explanatory Data Analysis)
Experimental Units: 30 cows

Factors of Interest: Diet, Week

Factor Levels: There are 1 of 3 different diets presented to each cow. These conditions are imposed over a 4 week period and measured

Treatments: The combination of one of 3 diets and one of 4 weeks at measure, yields 12 possible potential treatments. 

Nuisance Control: Diets were randomly assigned to the cows at the beginning.

```{r}
cows <- read.csv("cowStudy.csv", header = TRUE) 
cleanCows <- cows %>%
  mutate(Diet = as.factor(Diet),
         week = as.factor(week),
         Cow = as.factor(Cow),
         Name = paste(Diet, Cow))

glimpse(cleanCows)
```
```{r}
 cleanCows %>%
  group_by(Diet,week) %>%
  summarize(Mean = mean(protein),
            SD = sd(protein),
            Var = var(protein),
            N = n()) %>%
  kable()
```

Across all the weeks in all 3 diets, variance and mean values are changing with a general trend being mean values going down.
However, at almost every point, Barley appears to have a higher mean than the other two diets.


```{r}
ggplot(cleanCows)+
  aes(x= week, y= protein, color = Diet, group = Diet)+
  stat_summary(fun.y = mean, geom = "line") 
```

Judging purely based on sight, the Barley diet has the highest mean protein production at each week. The Lupins diet is the lowest
protein production until the very end, where it is replaced as lowest by the mixed. Over time, all mean protein production levels decrease over
time.

##Inference


Knowing that Diet is being tested for in the protein production in the milk of these cows over 4 time periods, a Repeated measures test seems 
to be the most fitting inferential technique to use, in order to determine if there is a significant difference between any of the three diets.


```{r}
cleanCows.anova <- aov(protein ~ week*Diet + Error(Name/week) ,data = cleanCows)
summary(cleanCows.anova)
```

Utilizing a  repeated measures design in which we measure the protein production of each cow over 4 weeks, we observe an insigificant value for the interaction term of diet to week. 
Breaking the interaction term up, we note an insignificant diet term with p = 0.403, and a significant week term of 4.87 x 10^-15.

At a 95% confidence interval, we can conclude that diet is not significant in predicting
a response value of protein, however the given week we measure does. To answer the original question, there is no statisically significant difference between
any of the three diets.





#Acid Rain Study
Experimental Units: Samples of soil

Factors of Interest: Acid Rain pH, Time Period of Measurements

Factor Levels: There are two levels of acid Rain pH, and 3 time periods of measurement 

Treatments: There are 6 combinations of acid Rain pH and time periods

Nuisance Control: Measuring at 3 different time periods acts to make experimental conditions homogeneous.

```{r}
rain <- read.csv("acidRainStudy.csv")
cleanRain <- rain %>%
  mutate(Rain.pH = as.factor(Rain.pH),
         Name = paste(Rain.pH, Depth))
glimpse(cleanRain)
```
```{r}
ggplot(cleanRain)+
  geom_line(aes(x = TimePeriod, y = Soil.pH, color= Rain.pH, linetype= Depth, group = Name)) 
```

Examining this graph comparing Soil pH over Time Period, we notice that soil pH has a tendency to increase at lower depths, with the highest pH being observed
at 30-45cm. With respect to Rain pH, although the highest point of Soil.pH is observed at the lowest rain pH, the remainder of the data is too close to make any visual judgements
on.

#Inference 

Given we know there is a homogeneous set of conditions at each field for each given Time Period point, a blocked Two-Way ANOVA makes the most sense to analyze our given
data.

```{r}
cleanRain.anova <- aov(Soil.pH ~ TimePeriod + Depth*Rain.pH , data = cleanRain)
summary(cleanRain.anova)
autoplot(cleanRain.anova)
```

We do not observe any obscene violations of Normality, nor do we observe any fanning with respect to the equal variance plot.

As given by the anova test conducted, the interaction term between depth and rain pH is not significant. Breaking the term up, Time Period is signifcant at all reasonable
confidence intervals (p = 0.000379). Rain pH is not a significant predictor(p = 0.110972), but our Depth factor is only a significant predictor at the 90% confidence level(p = 0.075920). We will run a multiple comparisons on the depth in order to observe more specific statisically significant data at this point.

#Multiple Comparisons

```{r}
cleanRain.mc <- emmeans(cleanRain.anova, "Depth")
contrast(cleanRain.mc, "pairwise")
plot(contrast(cleanRain.mc, "pairwise"), level = 0.90)
```

The multiple comparisons shows that the only statisically significant Depth difference is observed to be 30-45cm yields greater soil ph than 15-30cm.

##Conclusion

In conclusion, there is no statisically signifcant impact on soil pH due to acid rain levels. There is a single statisically significant point, by which 30-45 cm deep soil yields 
a sigificantly higher soil pH when compared to 15-30cm deep soil.


